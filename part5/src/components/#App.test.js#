import React from 'react';
import { render, waitForElement } from '@testing-library/react';
jest.mock('../services/blogs');
import { prettyDOM } from '@testing-library/dom';
import App from './App';

describe ('<App />', () => {
  test('if no user logged in, blogs are not rendered', async () => {
    const component = render(
      <App />
    );
    // component.rerender(<App />);
    
    // await waitForElement(() => component.container.querySelector('.login'));

    // console.log(prettyDOM(component.container));
    
    const login = component.container.querySelector('.login').parentElement;
    expect(login).toHaveStyle('display: none');
  });

  test('if a user is logged in, blogs are rendered', async () => {
    const component = render(
      <App />
    );

    const user = {
      username: "ChrispGuy",
      name: "Chrisp",
      token: '1231231214',
    };

    localStorage.setItem('loggedBlogAppUser', JSON.stringify(user));
    
    // component.rerender(<App />);
    
    const results = await waitForElement(() => getBy);
    console.log(results);

    console.log(prettyDOM(component.container));
  });
});
